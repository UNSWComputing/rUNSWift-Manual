

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>State Estimation &mdash; RoboCup SPL 2020 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Localiser" href="localiser.html" />
    <link rel="prev" title="Robot Detector" href="../vision/robot_detector.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> RoboCup SPL
          

          
            
            <img src="../../_static/rUNSWift.gif" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                2020
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../setup/index.html">Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../running/index.html">Running the Robot</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../architecture.html">Architecture</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Perception</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../vision/index.html">Vision</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">State Estimation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#architecture">Architecture</a></li>
<li class="toctree-l3"><a class="reference internal" href="#estimatorinfo-objects">EstimatorInfo Objects</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#estimatorinfoinit">EstimatorInfoInit</a></li>
<li class="toctree-l4"><a class="reference internal" href="#estimatorinfoin">EstimatorInfoIn</a></li>
<li class="toctree-l4"><a class="reference internal" href="#estimatorinfomiddle">EstimatorInfoMiddle</a></li>
<li class="toctree-l4"><a class="reference internal" href="#estimatorinfoout">EstimatorInfoOut</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#developing-testing">Developing / Testing</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#logging-state-estimation-input">Logging State Estimation Input</a></li>
<li class="toctree-l4"><a class="reference internal" href="#running-state-estimation-simulator">Running State Estimation Simulator</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#estimators">Estimators</a><ul>
<li class="toctree-l4"><a class="reference internal" href="localiser.html">Localiser</a></li>
<li class="toctree-l4"><a class="reference internal" href="ego_ball_tracker.html">Ego Ball Tracker</a></li>
<li class="toctree-l4"><a class="reference internal" href="team_ball_tracker.html">Team Ball Tracker</a></li>
<li class="toctree-l4"><a class="reference internal" href="robot_filter.html">Robot Filter</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../behaviour.html">Behaviour</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../motion/index.html">Motion</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../networking.html">Networking</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../3d_simulation.html">3D Simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/index.html">Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../game_preparation/index.html">Game Preparation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../debugging/index.html">Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../style_guide.html">Style Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/index.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../past_research.html">Past Research</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../code_releases_team_reports.html">Code Release / Team Reports</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contact.html">Contact</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">RoboCup SPL</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Perception</a> &raquo;</li>
        
      <li>State Estimation</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/UNSWComputing/rUNSWift-Manual/blob/master/source/perception/state_estimation/index.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="state-estimation">
<h1>State Estimation<a class="headerlink" href="#state-estimation" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>State Estimation’s purpose is to estimate the position and velocity of the robot, ball and other robots on the field.</p>
</div>
<div class="section" id="architecture">
<h2>Architecture<a class="headerlink" href="#architecture" title="Permalink to this headline">¶</a></h2>
<img alt="../../_images/state_estimation.png" src="../../_images/state_estimation.png" />
<p>State Estimation is structured in a way to allow off-board testing, since testing state estimation on-board the NAO is almost impossible. Off-board testing can be achieved by recording all the data from the blackboard that is required by the State Estimation Module, on the NAO while running,then copying this to your computer and feeding it through a state estimation simulator system off-board. For this structure, it is important that only StateEstimationAdapter can read to / write from the blackboard.</p>
<p>The State Estimation module is also written in such a way to allow easy additions/deletions/replacements of submodules, so future members can simply rewrite Estimators without being scared of breaking existing stuff!</p>
</div>
<div class="section" id="estimatorinfo-objects">
<h2>EstimatorInfo Objects<a class="headerlink" href="#estimatorinfo-objects" title="Permalink to this headline">¶</a></h2>
<p>Estimator Information objects simplify the logging of input data and passing of data between the estimators. The estimatorInfo objects are created in <code class="code docutils literal notranslate"><span class="pre">StateEstimationAdapter</span></code>, and passed by reference to the estimators.</p>
<div class="section" id="estimatorinfoinit">
<h3>EstimatorInfoInit<a class="headerlink" href="#estimatorinfoinit" title="Permalink to this headline">¶</a></h3>
<p>Object storing information that is known when runswift starts, that doesn’t change during execution.
(eg. Team Number, Player Number, Initial Robot Position)</p>
<p>Object is constructed upon program execution and destructed when the program is killed.</p>
</div>
<div class="section" id="estimatorinfoin">
<h3>EstimatorInfoIn<a class="headerlink" href="#estimatorinfoin" title="Permalink to this headline">¶</a></h3>
<p>Object storing information that is used in state estimation that changes throughout execution.
(eg. Field Features, Ball Updates, Odometry, Penalty State)</p>
<p>Object is constructed and destructed in StateEstimationAdapter every frame.</p>
</div>
<div class="section" id="estimatorinfomiddle">
<h3>EstimatorInfoMiddle<a class="headerlink" href="#estimatorinfomiddle" title="Permalink to this headline">¶</a></h3>
<p>Object storing information that is passed between estimators, but not going to be written to the blackboard.</p>
<p>Object is constructed and destructed in StateEstimationAdapter every frame.</p>
</div>
<div class="section" id="estimatorinfoout">
<h3>EstimatorInfoOut<a class="headerlink" href="#estimatorinfoout" title="Permalink to this headline">¶</a></h3>
<p>Object storing information that is going to be written back to the blackboard by <code class="code docutils literal notranslate"><span class="pre">StateEstimationAdapter</span></code>.</p>
<p>Object is constructed and destructed in StateEstimationAdapter every frame.</p>
</div>
</div>
<div class="section" id="developing-testing">
<h2>Developing / Testing<a class="headerlink" href="#developing-testing" title="Permalink to this headline">¶</a></h2>
<p>State Estimation is difficult to test and replicate, as what happens in a single tick depends on the previous state, which then depends on it’s previous state, etc….</p>
<p>Development can be achieved by recording the input data into state estimation in the simulator, or on the actual NAO.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Testing state estimation on-board the actual NAO is impossible as you can never replicate the same case when something goes wrong. Always record input data and run it through simulation for debugging.</p>
</div>
<div class="section" id="logging-state-estimation-input">
<h3>Logging State Estimation Input<a class="headerlink" href="#logging-state-estimation-input" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt>To log estimatorInfoInit and estimatorInfoIn,</dt>
<dd><ol class="first last arabic simple">
<li>Enable logging by setting <code class="code docutils literal notranslate"><span class="pre">save_estimator_objects_to_file=TRUE</span></code> under <code class="code docutils literal notranslate"><span class="pre">stateestimation</span></code> in <code class="code docutils literal notranslate"><span class="pre">runswift.cfg</span></code>.</li>
<li>(Optional: Change file name by the <code class="code docutils literal notranslate"><span class="pre">estimator_objects_file_name</span></code> option under <code class="code docutils literal notranslate"><span class="pre">stateestimation</span></code> options in <code class="code docutils literal notranslate"><span class="pre">runswift.cfg</span></code>. (eg. <code class="code docutils literal notranslate"><span class="pre">estimator_objects_file_name=test.txt</span></code>). Default is <code class="code docutils literal notranslate"><span class="pre">estimator_objects_record.txt</span></code>.</li>
</ol>
</dd>
</dl>
</div>
<div class="section" id="running-state-estimation-simulator">
<h3>Running State Estimation Simulator<a class="headerlink" href="#running-state-estimation-simulator" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt>To run the state estimation simulator,</dt>
<dd><ol class="first last arabic simple">
<li>Compile the state estimation simulator by running <code class="code docutils literal notranslate"><span class="pre">build-relwithdebinfo-2.8.sh</span> <span class="pre">state-estimation-simulator.bin</span></code>.</li>
<li>Run the simulator <code class="code docutils literal notranslate"><span class="pre">state-estimation-simulator-2.8.sh</span> <span class="pre">&lt;path/to/file&gt;</span></code>.
(eg. <code class="code docutils literal notranslate"><span class="pre">state-estimation-simulator-2.8.sh</span> <span class="pre">logs/record.txt</span></code>)</li>
</ol>
</dd>
</dl>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Don’t add hacks to state estimation. It is very easy to break it and hard to fix!</p>
</div>
</div>
</div>
<div class="section" id="estimators">
<h2>Estimators<a class="headerlink" href="#estimators" title="Permalink to this headline">¶</a></h2>
<p>There are currently four estimators.</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="localiser.html">Localiser</a></li>
<li class="toctree-l1"><a class="reference internal" href="ego_ball_tracker.html">Ego Ball Tracker</a></li>
<li class="toctree-l1"><a class="reference internal" href="team_ball_tracker.html">Team Ball Tracker</a></li>
<li class="toctree-l1"><a class="reference internal" href="robot_filter.html">Robot Filter</a></li>
</ul>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="localiser.html" class="btn btn-neutral float-right" title="Localiser" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../vision/robot_detector.html" class="btn btn-neutral float-left" title="Robot Detector" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, rUNSWift

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>